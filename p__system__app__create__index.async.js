(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{LiuA:function(e,a,t){"use strict";t.d(a,"a",function(){return h});var n=t("Ico4"),l=t.n(n),r=t("UWy3"),c=t.n(r),o=t("mK77"),i=t.n(o),u=t("efbE"),m=t("ORyx"),s=/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/g;function d(e){return s.test(e)}var p=[{name:"DashBoard",icon:"dashboard",path:"/"},{name:"\u5e94\u7528\u7ba1\u7406",icon:"appstore",path:"system/app",children:[{name:"\u521b\u5efa\u5e94\u7528",path:"create"},{name:"\u5e94\u7528\u5217\u8868",path:"list"},{name:"\u5206\u7ec4\u5217\u8868",path:"group"},{name:"\u670d\u52a1\u5217\u8868",path:"service"}]},{name:"\u7528\u6237\u7ba1\u7406",icon:"user",path:"system/user",children:[{name:"\u7528\u6237\u5217\u8868",path:"list"},{name:"\u65b0\u5efa\u7528\u6237",path:"create"}]}];function v(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",t=arguments.length>2?arguments[2]:void 0;return e.map(e=>{var n=e.path;d(n)||(n=a+e.path);var l=i()({},e,{path:n,authority:e.authority||t});return e.children&&(l.children=v(e.children,"".concat(a).concat(e.path,"/"),e.authority)),l})}var b=function(){var e=c()(l.a.mark(function e(){var a,t,n;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=[],t=[],e.prev=2,e.next=5,Object(u["b"])();case 5:t=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),console.warn("[WARN]:\u83b7\u53d6\u5e94\u7528\u62a5\u9519");case 11:return n=Object(m["groupBy"])(t,"group._id"),Object.keys(n).map(e=>{if(n[e]&&n[e].length>0){var l=Object(m["find"])(t,a=>a.group&&a.group._id===e);if(l){var r={name:l.name,icon:"hdd",path:"system/".concat(e),children:[]};n[e].map(e=>{r.children.push({name:e.name,path:e._id})}),a.push(r)}}}),e.abrupt("return",a);case 14:case"end":return e.stop()}},e,null,[[2,8]])}));return function(){return e.apply(this,arguments)}}(),h=function(){var e=c()(l.a.mark(function e(){var a,t;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=Object(m["cloneDeep"])(p),e.next=3,b();case 3:return t=e.sent,e.abrupt("return",v([...a,...t]));case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},efbE:function(e,a,t){"use strict";t.d(a,"b",function(){return i}),t.d(a,"c",function(){return u}),t.d(a,"e",function(){return m}),t.d(a,"d",function(){return s}),t.d(a,"a",function(){return d});t("cJDw");var n=t("pFz2"),l=t("JCdq"),r=t.n(l),c=r.a.create();c.interceptors.response.use(e=>{var a=e.data;if(0===a.status||a.success)return a.data;var t=a.msg||a.message||"\u63a5\u53e3\u8bf7\u6c42\u9519\u8bef:".concat(e.status);return n["a"].error({message:"\u63a5\u53e3\u8bf7\u6c42\u62a5\u9519",description:t}),Promise.reject(e)});var o="https://api.izhongxia.com",i=()=>{return c.get("".concat(o,"/api/v1/app"))},u=e=>{return c.get("".concat(o,"/api/v1/app/").concat(e))},m=()=>{return c.get("".concat(o,"/api/v1/service"))},s=()=>{return c.get("".concat(o,"/api/v1/group"))},d=e=>{if(!e._id)return c.post("".concat(o,"/api/v1/app"),e);var a=e._id;delete e._id,c.post("".concat(o,"/api/v1/app/").concat(a),e)}},"r+M4":function(e,a,t){"use strict";t.r(a);t("Gv9p");var n=t("4wE5"),l=(t("jxze"),t("baKk")),r=(t("wCQV"),t("Wpgy")),c=(t("f4gl"),t("GHNm")),o=(t("aHlT"),t("hhxt")),i=(t("5hcx"),t("paz3")),u=(t("99AR"),t("dm4L")),m=(t("oHTg"),t("twA4")),s=(t("lrJJ"),t("ECjy")),d=t("Ico4"),p=t.n(d),v=t("mK77"),b=t.n(v),h=t("UWy3"),g=t.n(h),E=t("cO38"),C=t.n(E),y=(t("O+Mt"),t("1z1q")),f=(t("jqTM"),t("n0rf")),x=t("uqIC"),O=t.n(x),k=t("16fl"),I=t.n(k),w=t("kES8"),j=t.n(w),M=t("ORyx"),D=t("efbE"),A=(t("WYSL"),t("n4pQ")),S=(t("dspT"),t("VYVj")),F=0,_={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},q={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},T=e=>{var a=e.name,t=e.data,n=e.label,r=e.btnLabel,c=e.renderItem,i=e.setData,u=t[a]||[];u.map(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e._key||(e._key=F++),e});var m={remove:e=>{var n=Object(M["cloneDeep"])(u);n.splice(e,1),i(b()({},t,{[a]:n}))},add:()=>{var e=u.concat({_key:F++});i(b()({},t,{[a]:e}))}},s=u.map((e,t)=>{return O.a.createElement(f["a"].Item,Object.assign({key:e._key},0===t?_:q,{label:0===t?n:"",required:!1}),O.a.createElement(S["a"],{gutter:24},c({key:t,item:e,name:a}),O.a.createElement(o["a"],{span:2},O.a.createElement(A["a"],{className:"dynamic-delete-button",type:"minus-circle-o",onClick:()=>m.remove(t)}))))});return O.a.createElement(O.a.Fragment,null,s,O.a.createElement(f["a"].Item,Object.assign({},q),O.a.createElement(l["a"],{type:"dashed",onClick:m.add,style:{width:300}},O.a.createElement(A["a"],{type:"plus"})," ",r)))},z=(t("NOgF"),t("vpJL")),N=(t("k1Ox"),t("DVMa")),L=(t("/3vi"),t("yw55")),J=(t("LiuA"),[{label:"\u6587\u672c\u6846",value:"text"},{label:"\u4e0b\u62c9\u6846",value:"select",hasOptions:!0},{label:"\u5355\u9009\u6846",value:"radios",hasOptions:!0,inline:!0},{label:"\u591a\u9009\u6846",value:"checkboxes",hasOptions:!0,inline:!0},{label:"\u65e5\u671f",value:"date"},{label:"\u65f6\u95f4",value:"time"},{label:"\u65e5\u671f+\u65f6\u95f4",value:"datetime"},{label:"\u65f6\u95f4\u8303\u56f4",value:"date-range"},{label:"\u591a\u884c\u6587\u672c",value:"textarea"},{label:"\u5f00\u5173",value:"switch"},{label:"\u56fe\u7247",value:"image"},{label:"\u989c\u8272",value:"color"},{label:"\u6570\u5b57\u6587\u672c\u6846",value:"number"},{label:"\u5206\u5272\u7ebf",value:"divider"},{label:"HTML",value:"html"},{label:"\u8bc4\u5206",value:"rating"},{label:"\u57ce\u5e02",value:"city"},{label:"\u6587\u4ef6\u4e0a\u4f20",value:"file"}]),K=f["a"].Item,P=y["a"].Option,B=e=>{var a=e.data,t=e.setData,n=e.apis,l=e.onChange,r={renderFormItem:e=>{var a=e.key,t=e.name,n=e.item;return O.a.createElement(O.a.Fragment,null,O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"label",value:n["label"],onChange:l.bind(null,"".concat(t,"[").concat(a,"].label"))})),O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"name",value:n["name"],onChange:l.bind(null,"".concat(t,"[").concat(a,"].name"))})),O.a.createElement(o["a"],{span:5},O.a.createElement(y["a"],{placeholder:"\u8bf7\u9009\u62e9\u7ec4\u4ef6\u7c7b\u578b",value:n["type"],onChange:l.bind(null,"".concat(t,"[").concat(a,"].type"))},J.map((e,a)=>O.a.createElement(P,{key:a,value:e.value},"".concat(e.value,"-").concat(e.label))))),O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"\u9ed8\u8ba4\u503c",value:n["value"],onChange:l.bind(null,"".concat(t,"[").concat(a,"].value"))})))},renderOperation:e=>{var a=e.key,t=e.name,n=e.item;return O.a.createElement(O.a.Fragment,null,O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"\u64cd\u4f5c\u5217\u540d\u79f0",value:n["label"],onChange:l.bind(null,"".concat(t,"[").concat(a,"].label"))})),O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"\u64cd\u4f5c\u6a21\u5757name",value:n["moduleName"],onChange:l.bind(null,"".concat(t,"[").concat(a,"].moduleName"))})))}};return O.a.createElement(O.a.Fragment,null,O.a.createElement(K,{label:"\u6570\u636e\u63a5\u53e3",required:!0},O.a.createElement(y["a"],{value:a.apiName,onChange:l.bind(null,"apiName")},n&&n.map((e,a)=>{return O.a.createElement(P,{key:a,value:e.name},e.name)}))),O.a.createElement(K,{label:"\u8868\u683c\u6570\u636e\u5b57\u6bb5"},O.a.createElement(c["a"],{type:"text",placeholder:"\u8868\u683c\u4f7f\u7528\u7684\u63a5\u53e3\u8fd4\u56de\u5b57\u6bb5, \u9ed8\u8ba4 data",value:a.dataField,onChange:l.bind(null,"dataField")})),O.a.createElement(T,{label:"\u641c\u7d22\u5b57\u6bb5",btnLabel:"\u6dfb\u52a0\u8868\u683c\u641c\u7d22\u5b57\u6bb5",name:"filter_controls",data:a,setData:t,renderItem:r.renderFormItem}),O.a.createElement(T,{label:"\u8868\u683c\u5b57\u6bb5",btnLabel:"\u6dfb\u52a0\u8868\u683c\u5b57\u6bb5",name:"columns",data:a,setData:t,renderItem:r.renderFormItem}),O.a.createElement(T,{label:"\u64cd\u4f5c\u5b57\u6bb5",btnLabel:"\u6dfb\u52a0\u64cd\u4f5c\u5b57\u6bb5",name:"columns_operation",data:a,setData:t,renderItem:r.renderOperation}))},W=e=>{var a=e.title,t=e.columns,c=e.name,o=e.data,m=e.setData,s=e.renderModal,d=void 0===s?()=>{}:s,p=Object(x["useState"])({visible:!1,currentIndex:-1,currentData:{}}),v=C()(p,2),h=v[0],g=v[1],E={toggle:()=>{g(b()({},h,{visible:!h.visible}))},save:e=>{var a=o[c]||[];-1!==h.currentIndex?a[h.currentIndex]=b()({},a[h.currentIndex],e):(a.push(b()({},e,{key:a.length})),m(b()({},o,{[c]:a}))),E.toggle()},edit:(e,a)=>{g({currentData:e,currentIndex:a,visible:!0})},delete:e=>{var a=o[c]||[];a.splice(e,1),m(b()({},o,{[c]:a}))}},y=Object(M["cloneDeep"])(t);return y.push({title:"\u64cd\u4f5c",dataIndex:"",key:"x",render:(e,a,t)=>O.a.createElement(O.a.Fragment,null,O.a.createElement("a",{href:"javascript:;",onClick:()=>{E.edit(a,t)}},"\u7f16\u8f91"),O.a.createElement(u["a"],{type:"vertical"}),O.a.createElement(i["a"],{title:"\u662f\u5426\u5220\u9664\u8be5\u7ec4\u4ef6\uff1f",onConfirm:()=>{E.delete(t)}},O.a.createElement("a",{href:"javascript:;"},"\u5220\u9664")))}),O.a.createElement(r["a"],{size:"small",title:a,style:{marginTop:10},extra:O.a.createElement(l["a"],{type:"primary",onClick:E.toggle},"\u6dfb\u52a0\u6a21\u5757")},O.a.createElement(n["a"],{size:"small",rowKey:"name",bordered:!0,pagination:!1,columns:y,dataSource:o[c]}),h.visible&&d({visible:h.visible,initData:h.currentData,onCancel:E.toggle,onOk:E.save}))},$=f["a"].Item,G=y["a"].Option,H={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},R=e=>{var a=e.title,t=e.visible,n=e.initData,l=e.onCancel,r=void 0===l?()=>{}:l,i=e.onOk,u=void 0===i?()=>{}:i,m=Object(x["useState"])({type:"text"}),s=C()(m,2),d=s[0],p=s[1];Object(x["useEffect"])(()=>{Object(M["isEmpty"])(n)||p(n)},[n]);var v={isShowOptions:e=>{var a=J.filter(a=>a.value===e);return!!(a&&a.length>0&&a[0].hasOptions)},onChange:(e,a)=>{var t=a.target?a.target.value:a,n=Object(M["cloneDeep"])(d);Object(M["set"])(n,e,t),p(n)},onSubmit:e=>{e.preventDefault(),["radios","checkboxes"].indexOf(d.type)>-1&&(d.inline=!0),u(d)}},b={renderFormItem:e=>{var a=e.key,t=e.name,n=e.item;return O.a.createElement(O.a.Fragment,null,O.a.createElement(o["a"],{span:10},O.a.createElement(c["a"],{placeholder:"label",value:n["label"],onChange:v.onChange.bind(null,"".concat(t,"[").concat(a,"].label"))})),O.a.createElement(o["a"],{span:10},O.a.createElement(c["a"],{placeholder:"value",value:n["value"],onChange:v.onChange.bind(null,"".concat(t,"[").concat(a,"].value"))})))}};return O.a.createElement(z["a"],{width:600,maskClosable:!1,title:a,visible:t,onCancel:r,onOk:v.onSubmit},O.a.createElement(f["a"],Object.assign({},H),O.a.createElement($,{label:"\u5b57\u6bb5\u540d\u79f0",required:!0},O.a.createElement(c["a"],{placeholder:"\u5b57\u6bb5\u7684\u4e2d\u6587\u540d",value:d.label,onChange:v.onChange.bind(null,"label")})),O.a.createElement($,{label:"\u5b57\u6bb5\u6807\u8bc6",required:!0},O.a.createElement(c["a"],{placeholder:"\u5b57\u6bb5\u7684\u6570\u636e\u6807\u8bc6",value:d.name,onChange:v.onChange.bind(null,"name")})),O.a.createElement($,{label:"\u5b57\u6bb5\u7c7b\u578b",required:!0},O.a.createElement(y["a"],{placeholder:"\u8bf7\u9009\u62e9\u7ec4\u4ef6\u7c7b\u578b",showSearch:!0,value:d.type,onChange:v.onChange.bind(null,"type")},J.map((e,a)=>O.a.createElement(G,{key:a,value:e.value},"".concat(e.value,"-").concat(e.label))))),v.isShowOptions(d.type)&&O.a.createElement(O.a.Fragment,null,O.a.createElement(T,{label:"\u9009\u9879\u5217\u8868",btnLabel:"\u6dfb\u52a0\u9009\u9879",name:"options",data:d,setData:p,renderItem:b.renderFormItem}),O.a.createElement($,{label:"\u52a8\u6001\u9009\u9879"},O.a.createElement(c["a"],{placeholder:"\u9009\u9879\u4ece\u63a5\u53e3\u83b7\u53d6",value:d.source,onChange:v.onChange.bind(null,"source")}))),O.a.createElement($,{label:"\u5b57\u6bb5\u9ed8\u8ba4\u503c"},O.a.createElement(c["a"],{value:d.value,onChange:v.onChange.bind(null,"value")}))))},V=f["a"].Item,U=y["a"].Option,Q=e=>{var a=e.data,t=e.setData,n=e.apis,l=e.onChange,r=[{title:"\u5b57\u6bb5\u540d\u79f0",dataIndex:"label"},{title:"\u5b57\u6bb5\u6807\u8bc6",dataIndex:"name"},{title:"\u5b57\u6bb5\u7c7b\u578b",dataIndex:"type"},{title:"\u9ed8\u8ba4\u503c",dataIndex:"value"}];return O.a.createElement(O.a.Fragment,null,O.a.createElement(V,{label:"\u63d0\u4ea4\u63a5\u53e3"},O.a.createElement(y["a"],{value:a.apiName,onChange:l.bind(null,"apiName")},n&&n.map((e,a)=>{return O.a.createElement(U,{key:a,value:e.name},e.name)}))),O.a.createElement(V,{label:"\u521d\u59cb\u5316\u63a5\u53e3"},O.a.createElement(y["a"],{placeholder:"\u4e0d\u8bbe\u7f6e\u5219\u4ece\u8868\u683c\u8bb0\u5f55\u83b7\u53d6\u6216\u8005\u4e3a\u7a7a",value:a.initApiName,onChange:l.bind(null,"initApiName")},O.a.createElement(U,{value:""},"\u4e0d\u9700\u8981"),n&&n.map((e,a)=>{return O.a.createElement(U,{key:a,value:e.name},e.name)}))),O.a.createElement(W,{title:"\u8868\u5355\u5b57\u6bb5\u5217\u8868",name:"controls",data:a,setData:t,columns:r,renderModal:e=>{return O.a.createElement(R,Object.assign({title:"\u6dfb\u52a0\u8868\u5355\u5b57\u6bb5"},e))}}))},Y=(t("A8b4"),t("DAl+")),Z=f["a"].Item,X=e=>{var a=e.data,t=e.onChange;return O.a.createElement(O.a.Fragment,null,O.a.createElement(Z,{label:"\u9875\u9762\u5730\u5740"},O.a.createElement(c["a"],{placeholder:"\u8bf7\u8f93\u5165IFrame\u5730\u5740",value:a.src,onChange:t.bind(null,"src")})),O.a.createElement(Z,{label:"IFrame\u9ad8\u5ea6"},O.a.createElement(Y["a"],{style:{width:"100%"},placeholder:"\u8bbe\u7f6eIFrame\u9ad8\u5ea6",value:a.height,onChange:t.bind(null,"height")})))},ee=f["a"].Item,ae=L["a"].Group,te={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},ne=e=>{var a=e.visible,t=e.initData,n=void 0===t?{}:t,l=e.apis,o=void 0===l?[]:l,i=e.onCancel,u=void 0===i?()=>{}:i,m=e.onOk,s=void 0===m?()=>{}:m,d=Object(x["useState"])({layout:"",type:"crud"}),p=C()(d,2),v=p[0],b=p[1];Object(x["useEffect"])(()=>{Object(M["isEmpty"])(n)||b(n)},[n]);var h={onChange:(e,a)=>{var t=a.target?a.target.value:a,n=Object(M["cloneDeep"])(v);Object(M["set"])(n,e,t),b(n)},onSubmit:e=>{e.preventDefault(),s(v)}},g={renderModuleConfigForm:()=>{switch(v.type){case"crud":return O.a.createElement(B,{data:v,setData:b,apis:o,onChange:h.onChange});case"form":return O.a.createElement(Q,{data:v,setData:b,apis:o,onChange:h.onChange});case"iframe":return O.a.createElement(X,{data:v,setData:b,apis:o,onChange:h.onChange});default:return O.a.createElement(N["a"],{type:"error",message:"\u6682\u65f6\u6ca1\u6709\u6539\u7ec4\u4ef6\u7c7b\u578b\u7684\u53ef\u89c6\u5316\u914d\u7f6e\u9875\u9762"})}}};return O.a.createElement(z["a"],{title:"\u6a21\u5757\u914d\u7f6e",width:1e3,maskClosable:!1,visible:a,onCancel:u,onOk:h.onSubmit},O.a.createElement(f["a"],Object.assign({},te),O.a.createElement(ee,{label:"\u6a21\u5757\u540d\u79f0",required:!0},O.a.createElement(c["a"],{placeholder:"\u6a21\u5757\u7684\u540d\u79f0",value:v.title,onChange:h.onChange.bind(null,"title")})),O.a.createElement(ee,{label:"\u6a21\u5757\u6807\u8bc6",required:!0},O.a.createElement(c["a"],{placeholder:"\u6a21\u5757\u6807\u8bc6\uff0c\u7528\u4e8e\u5176\u4ed6\u6a21\u5757\u8c03\u7528",value:v.name,onChange:h.onChange.bind(null,"name")})),O.a.createElement(ee,{label:"\u6a21\u5757\u5e03\u5c40",required:!0,help:"\u9ed8\u8ba4\u5e03\u5c40 => \u521d\u59cb\u4f1a\u6e32\u67d3\u5728\u9875\u9762\u4e0a ||  \u5f39\u7a97 => \u70b9\u51fb\u540e\u624d\u4f1a\u5f39\u51fa"},O.a.createElement(ae,{value:v.layout,onChange:h.onChange.bind(null,"layout")},O.a.createElement(L["a"],{value:""},"\u9ed8\u8ba4\u5e03\u5c40"),O.a.createElement(L["a"],{value:"dialog"},"\u5f39\u7a97"))),O.a.createElement(ee,{label:"\u6a21\u5757\u7c7b\u578b",required:!0},O.a.createElement(ae,{value:v.type,onChange:h.onChange.bind(null,"type")},O.a.createElement(L["a"],{value:"crud"},"crud"),O.a.createElement(L["a"],{value:"form"},"form"),O.a.createElement(L["a"],{value:"iframe"},"IFrame"))),O.a.createElement(r["a"],{size:"small",title:"".concat(v.type,"\u914d\u7f6e")},g.renderModuleConfigForm())))},le=f["a"].Item,re=y["a"].Option,ce={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},oe=e=>{var a=e.visible,t=e.initData,n=void 0===t?{}:t,l=e.onCancel,r=void 0===l?()=>{}:l,o=e.onOk,i=void 0===o?()=>{}:o,u=Object(x["useState"])({name:"",method:"get",path:"",remark:""}),m=C()(u,2),s=m[0],d=m[1];Object(x["useEffect"])(()=>{Object(M["isEmpty"])(n)||d(n)},[n]);var p={onChange:(e,a)=>{var t=a.target?a.target.value:a,n=Object(M["cloneDeep"])(s);Object(M["set"])(n,e,t),d(n)},onSubmit:e=>{e.preventDefault(),i(s)}};return O.a.createElement(z["a"],{title:"\u63a5\u53e3\u914d\u7f6e",maskClosable:!1,visible:a,onCancel:r,onOk:p.onSubmit},O.a.createElement(f["a"],Object.assign({},ce),O.a.createElement(le,{label:"\u63a5\u53e3\u6807\u8bc6",required:!0},O.a.createElement(c["a"],{placeholder:"\u63a5\u53e3\u6807\u8bc6\u5fc5\u987b\u4fdd\u8bc1\u5e94\u7528\u5185\u552f\u4e00",value:s.name,onChange:p.onChange.bind(null,"name")})),O.a.createElement(le,{label:"\u63a5\u53e3\u7c7b\u578b",required:!0},O.a.createElement(y["a"],{showSearch:!0,value:s.method,onChange:p.onChange.bind(null,"method")},O.a.createElement(re,{value:"get"},"GET"),O.a.createElement(re,{value:"post"},"POST"),O.a.createElement(re,{value:"delete"},"DELETE"),O.a.createElement(re,{value:"put"},"PUT"))),O.a.createElement(le,{label:"\u63a5\u53e3\u5730\u5740",required:!0},O.a.createElement(c["a"],{placeholder:"$id\u53ef\u4f7f\u7528\u53d8\u91cf\u540d\uff0ceg: /api/app/$id",value:s.path,onChange:p.onChange.bind(null,"path")})),O.a.createElement(le,{label:"\u63a5\u53e3\u63cf\u8ff0"},O.a.createElement(c["a"].TextArea,{placeholder:"\u4ecb\u7ecd\u63a5\u53e3",value:s.remark,onChange:p.onChange.bind(null,"remark")}))))},ie=f["a"].Item,ue=y["a"].Option,me={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:12}}},se=()=>{var e=Object(x["useState"])({_id:"",visibleModuleModal:!1,currentModule:{},currentModuleIndex:-1,visibleApiModal:!1,currentApi:{},currentApiIndex:-1}),a=C()(e,2),t=a[0],d=a[1],v=Object(x["useState"])({group:[],service:[]}),h=C()(v,2),E=h[0],k=h[1],w=Object(x["useState"])({}),A=C()(w,2),S=A[0],F=A[1];Object(x["useEffect"])(()=>{var e=j.a.parse(window.location.search),a=e.id;if(a){var n=function(){var e=g()(p.a.mark(function e(){var n,l;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(D["c"])(a);case 2:n=e.sent,n._id&&(l=JSON.parse(n.config),F(l),d(b()({},t,{_id:n._id})));case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();n()}var l=function(){var e=g()(p.a.mark(function e(){var a,t,n,l;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(D["d"])(),Object(D["e"])()]);case 2:a=e.sent,t=C()(a,2),n=t[0],l=t[1],k({group:n,service:l});case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();l()},[]);var _={onChange:(e,a)=>{var t=a.target?a.target.value:a,n=Object(M["cloneDeep"])(S);Object(M["set"])(n,e,t),F(n)},toggleComponentModal:()=>{d(b()({},t,{visibleModuleModal:!t.visibleModuleModal,currentModuleIndex:-1,currentModule:{}}))},saveComponent:e=>{var a=S["modules"]||[];-1!==t.currentModuleIndex?a[t.currentModuleIndex]=b()({},a[t.currentModuleIndex],e):(a.push(b()({},e,{key:a.length})),F(b()({},S,{modules:a}))),_.toggleComponentModal()},editComponent:(e,a)=>{d(b()({},t,{currentModule:e,currentModuleIndex:a,visibleModuleModal:!0}))},deleteComponent:e=>{var a=S.modules||[];a.splice(e,1),F(b()({},S,{modules:a}))},toggleApiModal:()=>{d(b()({},t,{visibleApiModal:!t.visibleApiModal}))},saveApi:e=>{var a=S["apis"]||[];-1!==t.currentApiIndex?a[t.currentApiIndex]=b()({},a[t.currentApiIndex],e):(a.push(b()({},e,{key:a.length})),F(b()({},S,{apis:a}))),_.toggleApiModal()},editAPi:(e,a)=>{d(b()({},t,{currentApi:e,currentApiIndex:a,visibleApiModal:!0}))},deleteApi:e=>{var a=S.apis||[];a.splice(e,1),F(b()({},S,{apis:a}))},onSubmit:function(){var e=g()(p.a.mark(function e(a){var n,l;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a.preventDefault(),n=Object(M["cloneDeep"])(S),l={name:n.title,group:n.group,service:n.service,remark:n.subTitle,config:JSON.stringify(n),version:1},t._id&&(l._id=t._id),e.next=6,Object(D["a"])(l);case 6:s["a"].success("\u521b\u5efa\u5e94\u7528\u6210\u529f~",1,()=>{I.a.push("/system/app/list")});case 7:case"end":return e.stop()}},e)}));function a(a){return e.apply(this,arguments)}return a}()},q={apiColumns:[{title:"\u63a5\u53e3\u540d\u79f0",dataIndex:"name"},{title:"\u63a5\u53e3\u7c7b\u578b",dataIndex:"method",render:e=>O.a.createElement(m["a"],{color:"purple"},String(e))},{title:"\u63a5\u53e3\u5730\u5740",dataIndex:"path"},{title:"\u64cd\u4f5c",dataIndex:"",key:"x",render:(e,a,t)=>O.a.createElement(x["Fragment"],null,O.a.createElement("a",{href:"javascript:;",onClick:()=>{_.editAPi(a,t)}},"\u7f16\u8f91"),O.a.createElement(u["a"],{type:"vertical"}),O.a.createElement(i["a"],{title:"\u662f\u5426\u5220\u9664\u8be5\u7ec4\u4ef6\uff1f",onConfirm:()=>{_.deleteApi(t)}},O.a.createElement("a",{href:"javascript:;"},"\u5220\u9664")))}],columns:[{title:"\u6a21\u5757\u6807\u9898",dataIndex:"title"},{title:"\u6a21\u5757\u6807\u8bc6",dataIndex:"name"},{title:"\u6a21\u5757\u5e03\u5c40",dataIndex:"layout",render:e=>O.a.createElement(m["a"],{color:"purple"},String(e)||"\u9ed8\u8ba4\u5e03\u5c40")},{title:"\u6a21\u5757\u7c7b\u578b",dataIndex:"type",render:e=>O.a.createElement(m["a"],{color:"purple"},String(e))},{title:"\u64cd\u4f5c",dataIndex:"",key:"x",render:(e,a,t)=>O.a.createElement(x["Fragment"],null,O.a.createElement("a",{href:"javascript:;",onClick:()=>{_.editComponent(a,t)}},"\u7f16\u8f91"),O.a.createElement(u["a"],{type:"vertical"}),O.a.createElement(i["a"],{title:"\u662f\u5426\u5220\u9664\u8be5\u7ec4\u4ef6\uff1f",onConfirm:()=>{_.deleteComponent(t)}},O.a.createElement("a",{href:"javascript:;"},"\u5220\u9664")))}]},z={renderFormItem:e=>{var a=e.key,t=e.name,n=e.item;return O.a.createElement(O.a.Fragment,null,O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"\u5168\u5c40\u6309\u94ae\u540d\u79f0",value:n["label"],onChange:_.onChange.bind(null,"".concat(t,"[").concat(a,"].label"))})),O.a.createElement(o["a"],{span:5},O.a.createElement(c["a"],{placeholder:"\u6a21\u5757\u6807\u8bc6",value:n["moduleName"],onChange:_.onChange.bind(null,"".concat(t,"[").concat(a,"].moduleName"))})))},renderBaseInfo:()=>{return O.a.createElement(O.a.Fragment,null,O.a.createElement(ie,{label:"\u5e94\u7528\u6807\u9898",required:!0},O.a.createElement(c["a"],{placeholder:"\u8bf7\u8f93\u5165\u5e94\u7528\u7684\u6807\u9898",value:S.title,onChange:_.onChange.bind(null,"title")})),O.a.createElement(ie,{label:"\u5e94\u7528\u4ecb\u7ecd",required:!0},O.a.createElement(c["a"],{placeholder:"\u63cf\u8ff0\u4e0b\u8fd9\u4e2a\u5e94\u7528\u6709\u4ec0\u4e48\u7528~~",value:S.subTitle,onChange:_.onChange.bind(null,"subTitle")})),O.a.createElement(ie,{label:"\u5e94\u7528\u7ec4",required:!0},O.a.createElement(y["a"],{placeholder:"\u8bf7\u9009\u62e9\u5e94\u7528\u6240\u5c5e\u7ec4",value:S.group,onChange:_.onChange.bind(null,"group")},E.group.map(e=>O.a.createElement(ue,{key:e._id,value:e._id},e.name)))),O.a.createElement(ie,{label:"\u670d\u52a1\u7ec4",required:!0},O.a.createElement(y["a"],{placeholder:"\u8bf7\u9009\u62e9\u5e94\u7528\u63a5\u53e3\u6240\u5728\u670d\u52a1",value:S.service,onChange:_.onChange.bind(null,"service")},E.service.map(e=>O.a.createElement(ue,{key:e._id,value:e._id},e.name)))),O.a.createElement(T,{label:"\u5de5\u5177\u680f\u6309\u94ae",btnLabel:"\u6dfb\u52a0\u5de5\u5177\u680f\u6309\u94ae (eg:\u6dfb\u52a0\u5e94\u7528)",name:"toolbar_controls",data:S,setData:F,renderItem:z.renderFormItem}))}};return O.a.createElement(f["a"],Object.assign({},me,{style:{padding:10,paddingBottom:50,overflow:"hidden"},onSubmit:_.onSubmit}),O.a.createElement(r["a"],{size:"small",title:"\u57fa\u672c\u4fe1\u606f"},z.renderBaseInfo()),O.a.createElement(r["a"],{size:"small",title:"\u63a5\u53e3\u5217\u8868",style:{marginTop:10},extra:O.a.createElement(l["a"],{type:"primary",onClick:_.toggleApiModal},"\u6dfb\u52a0\u63a5\u53e3")},O.a.createElement(n["a"],{size:"small",rowKey:"name",bordered:!0,pagination:!1,columns:q.apiColumns,dataSource:S["apis"]}),t.visibleApiModal&&O.a.createElement(oe,{visible:t.visibleApiModal,initData:t.currentApi,onCancel:_.toggleApiModal,onOk:_.saveApi})),O.a.createElement(r["a"],{size:"small",title:"\u6a21\u5757\u914d\u7f6e",style:{marginTop:10},extra:O.a.createElement(l["a"],{type:"primary",onClick:_.toggleComponentModal},"\u6dfb\u52a0\u6a21\u5757")},O.a.createElement(n["a"],{size:"small",rowKey:"name",bordered:!0,pagination:!1,columns:q.columns,dataSource:S["modules"]}),t.visibleModuleModal&&O.a.createElement(ne,{visible:t.visibleModuleModal,apis:S["apis"],modules:S["modules"],initData:t.currentModule,onCancel:_.toggleComponentModal,onOk:_.saveComponent})),O.a.createElement(l["a"],{size:"large",type:"primary",htmlType:"submit",style:{display:"block",width:300,margin:"40px auto"}},"\u4fdd\u5b58\u5e94\u7528"))};a["default"]=se}}]);